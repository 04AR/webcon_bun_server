let StickStatus={xPosition:0,yPosition:0,x:0,y:0,cardinalDirection:"C"};var JoyStick=function(t,e,i){var n=e?.title??"joystick",o=e?.width??0,a=e?.height??0,h=e?.internalFillColor??"#00AA00",d=e?.internalLineWidth??2,r=e?.internalStrokeColor??"#003300",c=e?.externalLineWidth??2,s=e?.externalStrokeColor??"#008000",l=e?.autoReturnToCenter??!0;i=i||function(t){};var u=document.getElementById(t);u.style.touchAction="none";var f=document.createElement("canvas");f.id=n,f.width=o||u.clientWidth,f.height=a||u.clientHeight,u.appendChild(f);var S=f.getContext("2d"),g=0,m=2*Math.PI,k=(f.width-(f.width/2+10))/2,v=k+5,x=k+30,w=f.width/2,C=f.height/2,y=f.width/10,E=-1*y,P=f.height/10,L=-1*P,p=w,G=C;function W(){S.beginPath(),S.arc(w,C,x,0,m,!1),S.lineWidth=c,S.strokeStyle=s,S.stroke()}function F(){S.beginPath(),p=Math.max(v,Math.min(f.width-v,p)),G=Math.max(v,Math.min(f.height-v,G)),S.arc(p,G,k,0,m,!1);var t=S.createRadialGradient(w,C,5,w,C,200);t.addColorStop(0,h),t.addColorStop(1,r),S.fillStyle=t,S.fill(),S.lineWidth=d,S.strokeStyle=r,S.stroke()}function M(){let t="",e=p-w,i=G-C;return i>=L&&i<=P?t="C":i<L?t="N":i>P&&(t="S"),e<E?t="C"===t?"W":t+"W":e>y&&(t="C"===t?"E":t+"E"),t}function R(t){if(t.target!==f)return;let e=t.targetTouches?t.targetTouches[0]:t;p=e.pageX-f.offsetLeft-(f.offsetParent?.offsetLeft||0),G=e.pageY-f.offsetTop-(f.offsetParent?.offsetTop||0),S.clearRect(0,0,f.width,f.height),W(),F(),StickStatus.xPosition=p,StickStatus.yPosition=G,StickStatus.x=((p-w)/v*100).toFixed(),StickStatus.y=((G-C)/v*100*-1).toFixed(),StickStatus.cardinalDirection=M(),i(StickStatus)}"ontouchstart"in document.documentElement?(f.addEventListener("touchstart",(t=>{g=1,R(t)}),!1),document.addEventListener("touchmove",(t=>{g&&R(t)}),!1),document.addEventListener("touchend",(()=>{g=0,l&&(p=w,G=C),S.clearRect(0,0,f.width,f.height),W(),F()}),!1)):(f.addEventListener("mousedown",(t=>{g=1,R(t)}),!1),document.addEventListener("mousemove",(t=>{g&&R(t)}),!1),document.addEventListener("mouseup",(()=>{g=0,l&&(p=w,G=C),S.clearRect(0,0,f.width,f.height),W(),F()}),!1)),W(),F(),this.GetWidth=()=>f.width,this.GetHeight=()=>f.height,this.GetPosX=()=>p,this.GetPosY=()=>G,this.GetX=()=>((p-w)/v*100).toFixed(),this.GetY=()=>((G-C)/v*100*-1).toFixed(),this.GetDir=()=>M()};